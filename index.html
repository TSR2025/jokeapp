<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Joke Button</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: #f5f6f8;
        color: #1d1f22;
        padding: 24px;
      }

      .card {
        width: min(520px, 100%);
        background: #ffffff;
        border-radius: 16px;
        padding: 32px 28px;
        box-shadow: 0 12px 32px rgba(15, 23, 42, 0.12);
        text-align: center;
      }

      h1 {
        margin: 0 0 20px;
        font-size: clamp(1.6rem, 4vw, 2.2rem);
      }

      button {
        border: none;
        background: #2563eb;
        color: #ffffff;
        font-size: 1.05rem;
        font-weight: 600;
        padding: 14px 28px;
        border-radius: 999px;
        cursor: pointer;
        width: 100%;
        max-width: 240px;
        transition: transform 0.1s ease, opacity 0.2s ease;
      }

      button:active {
        transform: scale(0.98);
      }

      button:disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }

      .results {
        margin-top: 24px;
        display: grid;
        gap: 18px;
        text-align: left;
      }

      .joke-panel {
        border-radius: 14px;
        padding: 18px;
        border: 1px solid #e2e8f0;
        background: #f8fafc;
      }

      .joke-panel h2 {
        margin: 0 0 6px;
        font-size: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .worker-meta {
        margin-bottom: 12px;
        font-size: 0.9rem;
        color: #475569;
      }

      .status {
        min-height: 24px;
        font-size: 0.95rem;
      }

      .setup {
        margin-top: 12px;
        font-size: 1.05rem;
      }

      .punchline {
        margin-top: 8px;
        font-size: 1.15rem;
        font-weight: 700;
      }

      .error {
        color: #b91c1c;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background: #0f172a;
          color: #e2e8f0;
        }

        .card {
          background: #111827;
          box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
        }

        .joke-panel {
          background: #0b1220;
          border-color: #1f2937;
        }

        .worker-meta {
          color: #94a3b8;
        }
      }
    </style>
  </head>
  <body>
    <main class="card">
      <h1>Need a laugh?</h1>
      <button id="jokeButton" type="button">Tell me a joke</button>
      <section class="results" aria-live="polite">
        <article class="joke-panel" id="rawJokePanel">
          <h2>Worker A: Raw Joke</h2>
          <div class="worker-meta">
            Source: <span id="rawWorkerUrl">https://YOUR-WORKER-A-URL/joke</span>
          </div>
          <div class="status" id="rawStatus"></div>
          <div class="setup" id="rawSetup"></div>
          <div class="punchline" id="rawPunchline"></div>
        </article>
        <article class="joke-panel" id="chatGptJokePanel">
          <h2>Worker B: ChatGPT Tooling</h2>
          <div class="worker-meta">
            Source: <span id="chatWorkerUrl">https://YOUR-WORKER-B-URL/joke</span>
          </div>
          <div class="status" id="chatStatus"></div>
          <div class="setup" id="chatSetup"></div>
          <div class="punchline" id="chatPunchline"></div>
        </article>
      </section>
    </main>

    <script>
      const RAW_WORKER_URL = "https://YOUR-WORKER-A-URL/joke";
      const CHATGPT_WORKER_URL = "https://YOUR-WORKER-B-URL/joke";

      const button = document.getElementById("jokeButton");
      const rawStatus = document.getElementById("rawStatus");
      const rawSetup = document.getElementById("rawSetup");
      const rawPunchline = document.getElementById("rawPunchline");
      const chatStatus = document.getElementById("chatStatus");
      const chatSetup = document.getElementById("chatSetup");
      const chatPunchline = document.getElementById("chatPunchline");

      const clearPanel = (statusEl, setupEl, punchlineEl) => {
        statusEl.textContent = "";
        statusEl.classList.remove("error");
        setupEl.textContent = "";
        punchlineEl.textContent = "";
      };

      const loadJoke = async (url, statusEl, setupEl, punchlineEl) => {
        statusEl.textContent = "Loadingâ€¦";

        try {
          const response = await fetch(url, { method: "GET" });
          if (!response.ok) {
            throw new Error("Unable to fetch a joke right now.");
          }

          const data = await response.json();
          if (!data?.setup || !data?.punchline) {
            throw new Error("The joke format looks unexpected.");
          }

          setupEl.textContent = data.setup;
          punchlineEl.textContent = data.punchline;
          statusEl.textContent = "";
        } catch (error) {
          statusEl.textContent = error.message;
          statusEl.classList.add("error");
        }
      };

      button.addEventListener("click", async () => {
        clearPanel(rawStatus, rawSetup, rawPunchline);
        clearPanel(chatStatus, chatSetup, chatPunchline);
        button.disabled = true;

        try {
          await Promise.all([
            loadJoke(RAW_WORKER_URL, rawStatus, rawSetup, rawPunchline),
            loadJoke(CHATGPT_WORKER_URL, chatStatus, chatSetup, chatPunchline),
          ]);
        } finally {
          button.disabled = false;
        }
      });
    </script>
  </body>
</html>
