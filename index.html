<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Joke Button</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: #f5f6f8;
        color: #1d1f22;
        padding: 24px;
      }

      .card {
        width: min(520px, 100%);
        background: #ffffff;
        border-radius: 16px;
        padding: 32px 28px;
        box-shadow: 0 12px 32px rgba(15, 23, 42, 0.12);
        text-align: center;
      }

      h1 {
        margin: 0 0 20px;
        font-size: clamp(1.6rem, 4vw, 2.2rem);
      }

      button {
        border: none;
        background: #2563eb;
        color: #ffffff;
        font-size: 1.05rem;
        font-weight: 600;
        padding: 14px 28px;
        border-radius: 999px;
        cursor: pointer;
        width: 100%;
        max-width: 240px;
        transition: transform 0.1s ease, opacity 0.2s ease;
      }

      button:active {
        transform: scale(0.98);
      }

      button:disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }

      .status {
        margin-top: 18px;
        min-height: 24px;
        font-size: 1rem;
      }

      .setup {
        margin-top: 18px;
        font-size: 1.05rem;
      }

      .punchline {
        margin-top: 8px;
        font-size: 1.2rem;
        font-weight: 700;
      }

      .error {
        color: #b91c1c;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background: #0f172a;
          color: #e2e8f0;
        }

        .card {
          background: #111827;
          box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
        }
      }
    </style>
  </head>
  <body>
    <main class="card">
      <h1>Need a laugh?</h1>
      <button id="jokeButton" type="button">Tell me a joke</button>
      <div class="status" id="status"></div>
      <div class="setup" id="setup"></div>
      <div class="punchline" id="punchline"></div>
    </main>

    <script>
      const WORKER_URL = "https://snowy-star-11e8.taranjit-r.workers.dev/joke";

      const button = document.getElementById("jokeButton");
      const status = document.getElementById("status");
      const setup = document.getElementById("setup");
      const punchline = document.getElementById("punchline");

      const clearDisplay = () => {
        status.textContent = "";
        status.classList.remove("error");
        setup.textContent = "";
        punchline.textContent = "";
      };

      button.addEventListener("click", async () => {
        clearDisplay();
        button.disabled = true;
        status.textContent = "Loading…";

        try {
          const response = await fetch(WORKER_URL, { method: "GET" });
          if (!response.ok) {
            throw new Error("Unable to fetch a joke right now.");
          }

          const data = await response.json();
          if (!data?.setup || !data?.punchline) {
            throw new Error("The joke format looks unexpected.");
          }

          setup.textContent = data.setup;
          punchline.textContent = data.punchline;
        } catch (error) {
          status.textContent = error.message;
          status.classList.add("error");
        } finally {
          status.textContent = status.textContent === "Loading…" ? "" : status.textContent;
          button.disabled = false;
        }
      });
    </script>
  </body>
</html>
